<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Wake model · CCBlade.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">CCBlade.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Intro</a></li><li><a class="tocitem" href="../tutorial/">Quick Start</a></li><li><a class="tocitem" href="../howto/">Guided Examples</a></li><li><a class="tocitem" href="../reference/">API Reference</a></li><li><a class="tocitem" href="../theory/">Theory</a></li><li class="is-active"><a class="tocitem" href>Wake model</a><ul class="internal"><li><a class="tocitem" href="#Induced-velocities"><span>Induced velocities</span></a></li><li><a class="tocitem" href="#Adapted-BEM-equations"><span>Adapted BEM equations</span></a></li><li><a class="tocitem" href="#TODO"><span>TODO</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Wake model</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Wake model</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/byuflowlab/CCBlade.jl/blob/master/docs/src/wake_model.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Cylinder-wake-model"><a class="docs-heading-anchor" href="#Cylinder-wake-model">Cylinder wake model</a><a id="Cylinder-wake-model-1"></a><a class="docs-heading-anchor-permalink" href="#Cylinder-wake-model" title="Permalink"></a></h1><p>We explain how the cylinder wake model is implemented, and we go over the related modifications in the BEM equations.</p><p>The purpose of this model is to account for radial flow components, and wake skewness. It can be seen as a generalization of other skewed inflow models such as Pitt &amp; Peters, etc. It is based on a cylindrical representation of the wake, as proposed in [Branlard2015] and [Branlard2016]. As argued in [Crawford2006] and [McWilliams2011], the so-derived BEM has improved accuracy for cases with precone and yaw.</p><h2 id="Induced-velocities"><a class="docs-heading-anchor" href="#Induced-velocities">Induced velocities</a><a id="Induced-velocities-1"></a><a class="docs-heading-anchor-permalink" href="#Induced-velocities" title="Permalink"></a></h2><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>For details on this section, see [Branlard2016]. Illustrations from this section are also mostly taken from there.</p></div></div><h3 id="Principle"><a class="docs-heading-anchor" href="#Principle">Principle</a><a id="Principle-1"></a><a class="docs-heading-anchor-permalink" href="#Principle" title="Permalink"></a></h3><p>The wake geometry of the wake is assumed fixed. It is composed of a semi-inifinite outer cylindrical vortex sheet of radius <code>R</code>, a disk vortex sheet at the location of the rotor and a semi-infinite root vortex filament. The disk has a purely radial vorticity component, and the outer cylindrical sheet has two separate components: axial and tangential.  The vorticity/circulation in those elements is assumed uniformly constant.</p><p>The indice <span>$r$</span> refers to the root axial vorticity, <span>$b$</span> to the bound vorticity on the disk, <span>$t$</span> to the tangential vorticity in the outer sheet, and <span>$l$</span> to the axial/longitudinal vorticity in the outer sheet.</p><p><img src="../wake2.png" alt/></p><p>All the vortex instensity components in the different wake objects are related, see next section. For now, let us assume that they are all linearly dependant on <span>$\gamma_t$</span>. This will be convenient since the usual result from the Biot-Savart law is <span>$u_{x_0} = \gamma_t / 2$</span>, where <span>$u_{x_0}$</span> is the velocity induced at the edge of a straight circular cylinder with uniform tangential vorticity.</p><p>To include yaw, we allow the wake to be skewed by an angle <span>$\chi$</span> with respect to the rotor frame of reference. Mind the coordinate system attached to the rotor, which does not follow wind turbine conventions!</p><p><img src="../wake1.png" alt/></p><p>In those conditions, we can compute the velocity induced by each of the vortex component (for a given <span>$\gamma_t$</span>) from each object on a point located on the rotor disk.  This comes down to numerically integrate [Branlard2016, eq.5-8], which we do with Gauss-Legendre quadrature.</p><p>For example, we set <span>$\chi = 30^o$</span>, <span>$\gamma_t = -1$</span>. The axial velocity (z) induced by the tangential component of the outer vorticity cylinder (t) is <span>$u_{z,t}$</span>:</p><p><img src="../sampl_uzt.png" alt/></p><p>The radial and tangential velocities induced by the tangential component of the outer vorticity cylinder (resp. <span>$u_{r,t}$</span>, <span>$u_{\psi,t}$</span>) are also shown:</p><p><img src="../sampl_urt.png" alt/></p><p>Similarly, the axial velocity induced by the root vortex <span>$u_{z,r}$</span> (assuming <span>$\Gamma_{r} = -1$</span>):</p><p><img src="../sampl_uzr.png" alt/></p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The dominating  wake component on the induced velocities are those from the tangential vorticity in the outer cylinder, and the axial vorticity in the root vortex, see [Branlard2016, sect.4].</p></div></div><h3 id="Expressions-of-the-induced-velocities-from-the-respective-wake-components"><a class="docs-heading-anchor" href="#Expressions-of-the-induced-velocities-from-the-respective-wake-components">Expressions of the induced velocities from the respective wake components</a><a id="Expressions-of-the-induced-velocities-from-the-respective-wake-components-1"></a><a class="docs-heading-anchor-permalink" href="#Expressions-of-the-induced-velocities-from-the-respective-wake-components" title="Permalink"></a></h3><p>From here on, we resume with standard wind-turbine conventions regarding frame of references.</p><p>Crucially, we still assume the independance of annular sections on the rotor (even though it is provably doubtful) we want to keep a simple numerical method. A formal motivation for this is given in [Branlard2015, sect.4.3] for the case of the straight cylinder wake model. In practice this means the following: every anular section has an associated bound vorticity <span>$\gamma_b$</span> that corresponds to the circulation of the blades at that location. Neglecting the circulation of all the other anular sections, the vorticity in all other wake components may be expressed as a function of the bound vorticity, by the Kelvin theorem (circulation is conserved). We thus have (see also [Branlard2016, 2.3]):</p><p class="math-container">\[\Gamma_r = -2\pi r \gamma_b \]</p><p class="math-container">\[\gamma_l = -\frac{\Gamma_r}{2\pi R}\]</p><p class="math-container">\[\gamma_t = -\frac{\Gamma_r}{h / cos(\chi)}\]</p><p>where <span>$h$</span> is the pitch of the helix formed by the tangential and axial components in the outer vortex sheet. At high TSR (<span>$\lambda$</span>), the latter can be evaluated as <span>$h=\frac{\pi R}{\lambda} (1 + \sqrt{1-C_T})$</span> (see [Branlard2015, sect.4] and refs therein).</p><p>As mentioned before, we rather express the various vorticity/circulations as a function of <span>$\gamma_t$</span>:</p><p class="math-container">\[\Gamma_r = -\gamma_t \frac{h}{\cos\chi} \]</p><p class="math-container">\[\gamma_l = \frac{\gamma_t}{2\pi R} \frac{h}{\cos\chi} \]</p><p class="math-container">\[\gamma_b = \frac{\gamma_t}{2\pi r} \frac{h}{\cos\chi} \]</p><p>Note that all are linear in <span>$\gamma_t$</span>.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>In the following, we neglect the influence of the bound vorticity on the velocity measured in the rotor plane. This is mainly to decouple the BEM computation from each blade.</p></div></div><p>The axial, tangential and radial induced velocities at the rotor are</p><p class="math-container">\[u_x = u_{x,t} + u_{x,r} + u_{x,l} \overset{\Delta}{=} I_x \gamma_t\]</p><p class="math-container">\[u_\psi = u_{\psi,t} + u_{\psi,r} + u_{\psi,l} \overset{\Delta}{=} I_\psi \gamma_t\]</p><p class="math-container">\[u_r = u_{r,t} + u_{r,l} \overset{\Delta}{=} I_r \gamma_t\]</p><p>Notice that the root vortex never induces radial velocity.</p><p>The <span>$I$</span> factors are the previously-mentioned integrals that only depend on geometric factors: <span>$(r,R,\psi,x,\chi)$</span>. In practice, in spite of the blade bending and/or (pre)cone, we always evaluate <span>$I$</span> at <span>$x=0$</span>. The reason is that the head of the cylinder model is flat and passes through the rotor hub. Hence, it makes more sense to evaluate induced velocity in the rotor plane. We also neglect the influence of the tilt angle on <span>$I$</span>.</p><div class="admonition is-danger"><header class="admonition-header">Danger</header><div class="admonition-body"><p>TODO: for completeness, write the expressions for <span>$I_\cdot$</span>, and be careful with the change of convention between Branlart and standard WT.</p></div></div><p>In the far wake, the induced velocities are</p><p class="math-container">\[u_{x_2} = \gamma_t\]</p><p class="math-container">\[u_{\psi_2} = \left. u_{\psi,r} \right|_{x\rightarrow\infty} = \frac{\Gamma_r}{2\pi r \cos\chi \cos\Theta}  \overset{\Delta}{=} I_{\psi_2} \gamma_t\]</p><p class="math-container">\[u_{r_2} = 0\]</p><p>since <span>$u_{\psi,l}$</span> is uniformly zero inside the cylinder wake, and there is no tangential velocity induced by the tangential vorticity component.</p><h3 id="Usage-in-the-BEM"><a class="docs-heading-anchor" href="#Usage-in-the-BEM">Usage in the BEM</a><a id="Usage-in-the-BEM-1"></a><a class="docs-heading-anchor-permalink" href="#Usage-in-the-BEM" title="Permalink"></a></h3><p>We showed that the induced veloctities at the rotor can be expressed as</p><p class="math-container">\[\begin{aligned}
u_x &amp;= I_x \gamma_t \\
u_\psi &amp;= I_\psi \gamma_t 
u_r &amp;= I_r \gamma_t \\
\end{aligned}\]</p><p>where, again, the <span>$I$</span> factors are computed numerically and do not depend on <span>$\gamma$</span></p><p>For the sequel, it will be convenient to define <code>epsilon factors</code>. The conventional result generally used in BEM corresponds to <span>$\epsilon_x= \epsilon_\psi =1$</span>. Conventional BEM also neglects <span>$u_r$</span> (i.e., <span>$\epsilon_r=0$</span> ).</p><p class="math-container">\[\begin{aligned}
u_x \epsilon_x &amp;= \gamma_t / 2 \\
u_\psi \epsilon_\psi &amp;= u_{\psi_2} / 2 \\ 
u_r &amp;= \epsilon_r u_x 
\end{aligned}\]</p><p>such that</p><p class="math-container">\[\begin{aligned}
\epsilon_x &amp;= 1 / (2 I_x) \\
\epsilon_\psi &amp;= \frac12 \frac{I_{\psi_2}}{I_\psi} \\ 
\epsilon_r &amp;= I_r / I_x 
\end{aligned}\]</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p><strong>Relation to other skewed wake models</strong></p><p>As noted in [Branlard2016], the cylinder wake model can be seen as a generalization of other models that have been proposed to treat yaw. The relation between these models and the current one is established by noticing that the axial induced velocity has the form of the model proposed by Glauert:</p><p class="math-container">\[u_x = \frac{\gamma_t}{2} (1 + K \sin\psi)\]</p><p>where <span>$K$</span> has an expression that depends on the model.</p><p>For the <code>Coleman et al.</code> model for instance, </p><p class="math-container">\[K_{\textrm{PittPeters}} = \frac{r}{R} \tan(\chi/2)\]</p><p>The <code>Pitt &amp; Peters</code> model gives, </p><p class="math-container">\[K_{\textrm{Coleman}} = \frac{r}{R} \frac{15\pi}{32} \tan(\chi/2)\]</p><p>although some authors proposed to use a factor <span>$15\pi/64$</span> instead (see [Ning2015]). Other models can be found in the litterature (see e.g. [Micallef2016])</p><p>In the present model, <span>$u_x$</span> is influenced by the various component of vorticity in the wake (see the above equation <span>$u_x = u_{x,t} + u_{x,r} + u_{x,l}$</span>). In that sense it is more general. However, we can establish a link with the above simple models if we we consider only the velocity induced by the tangential component of the tip vorticity (neglecting <span>$u_{x,r}$</span> and <span>$u_{x,l}$</span>).  Indeed, the velocity induced by the tangential vorticity in the cylinder also has the form <span>$u_{x,t} = \frac{\gamma_t}{2} (1 + K_{x,t} \sin\psi)$</span>, where <span>$K_{x,t}$</span> takes the form of an integral that needs to be computed numerically. Furthermore, we can show that the linearization of <span>$K_{x,t}$</span> leads us to recover the exact same expression for <span>$K$</span> as the <code>Coleman et al.</code> model.</p></div></div><h2 id="Adapted-BEM-equations"><a class="docs-heading-anchor" href="#Adapted-BEM-equations">Adapted BEM equations</a><a id="Adapted-BEM-equations-1"></a><a class="docs-heading-anchor-permalink" href="#Adapted-BEM-equations" title="Permalink"></a></h2><p>We re-develop the BEM equations following the same logic as in [Ning2021], but for the general case of a turbine with yaw and non-straight/preconed blades. We make use of the definitions of the epsilon factors, and the standard definition of the induction factors:</p><p class="math-container">\[a = \frac{u_x}{V_x} \quad a&#39; = \frac{u_\psi}{V_y}\]</p><p>We refer the interested reader to <a href="and refs. therein">Branlard2015, sect.4.2</a> for a formal explanation of the relation between the BEM theory and the vortex-induced velocity.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>The sign conventions used here may depend on the type of operation (turbine/propeller). We follow the same definitions as in [Ning2021]. </p></div></div><p>We account for a yaw angle <span>$\chi_0$</span>. At a given radial station <span>$r$</span> measured along the blade, the local coning and sweep angles are <span>$\beta$</span> and <span>$s$</span>, and the distance to the rotor shaft is <span>$r_a \approx z_a$</span> (see figures below). </p><p>The main idea behind this development is to relate the local forces on the blades (which depend on the 2D aerodynamics expressed in a plane normal to the deflected blade) to the updated  momentum equations. <strong>The axial momentum (both axial and angular) is expressed in the direction normal to the rotor plane</strong> (see reference frames hereafter).</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Generally, the yaw angle <span>$\chi_0$</span> is smaller than the skew angle <span>$\chi$</span>. See references in [Branlard2016, sect.2.1] for relations between them. If we neglect the tilt angle, we can simply use the relation from Burton&#39;s Wind Energy handbook [Ning2015, eq.31]</p><p class="math-container">\[\chi = (0.6 a + 1) \chi_0\]</p><div class="admonition is-danger"><header class="admonition-header">Danger</header><div class="admonition-body"><p>:warning: should clarify if <span>$a = u_x/V_\infty$</span> or <span>$a = u_{x_2}/V_\infty$</span> in that formula</p></div></div><p><img src="../yaw_skew.png" alt/></p></div></div><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Notations: <span>$V_i$</span> are external velocities (from the inflow and the rotation); <span>$u_i$</span> are wake-induced velocities; <span>$U_i$</span> are the sum of <span>$V_i$</span> and <span>$u_i$</span>.</p></div></div><h3 id="Reference-frames"><a class="docs-heading-anchor" href="#Reference-frames">Reference frames</a><a id="Reference-frames-1"></a><a class="docs-heading-anchor-permalink" href="#Reference-frames" title="Permalink"></a></h3><p>We present some figures modified from [Ning2015].</p><p>Looking at the turbine from a multi-body perspective, the chaining between frames and corresponding rotations and angle is the following:</p><p><img src="../frames.png" alt/></p><p>For the purpose of the present BEM implementation however, we introduce an approximation that corresponds to slightly altering that order, as follows:</p><p><img src="../frames_tweaked.png" alt/></p><p>What this approximation does is that it considers that the pitch actuation results in uniformly modifying the airfoil pitch angle along the blade span, as if it was locally twisted instead of being &#39;rigidly&#39; rotated at the root. This essentially affects deformed/non-straight blades, and does not change anything  for straight blades. We will see hereafter that this assumption his crucial in decoupling tangential and axial inductions, resulting in equations that can be solved sequentially.</p><p><strong>Rotor-related frame:</strong></p><p><img src="../rotor_frame.png" alt/></p><p>We will express the momentum in the direction normal to the rotor plane (after yaw and tilt, <strong>before coning and sweep</strong>). That is where our <span>$x,y,z \equiv x_{az},y_{az},z_{az}$</span> coordinate system is defined. </p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Definitions (caution: tilt and precone are inverted w.r.t. AeroDyn!):</p><ul><li>positive tilt results in rotor facing upwards (upwind turbines have <span>$\Theta &gt; 0$</span>)</li><li>positive precone results in blade leaning forward (upwind turbines have <span>$\beta_0 &gt; 0$</span>)</li><li>positive yaw results in the wind coming from your right if you sit on top of the hub facing the wind</li></ul><div class="admonition is-danger"><header class="admonition-header">Danger</header><div class="admonition-body"><p>TODO: check yaw convention throughout the code</p></div></div><p>(Hence, for <span>$\psi=0$</span>, <span>$\beta=-\beta_0$</span> gives the same results <span>$\forall \beta$</span>)</p></div></div><p><strong>Blade related-frames:</strong></p><p>The blade root frame is handy because we expect that any structural code will output the blade deformation in those coordinates. For a straight blade, we will have <span>$z_a= r$</span> and <span>$x_a = y_a = 0$</span>.</p><p><img src="../blade_frame.png" alt/></p><p>Note that <span>$\beta$</span> is the local coning angle (that accounts only for flapwise bending). </p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Another potentially useful assumption is <em>sweep through shearing</em> that replaces <span>$r,t$</span> with <span>$r&#39;,t&#39;$</span>. This consists in neglecting the change of orientation of the blade related to sweep, leaving <span>$r&#39;$</span> parallel to <span>$z_a$</span>.</p><div class="admonition is-danger"><header class="admonition-header">Danger</header><div class="admonition-body"><p>Need to assess the necessity of this assumption.</p></div></div></div></div><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Definitions</p><ul><li>positive conicity is a positive rotation about <code>y</code>, that is downwards (i.e., opposed to the precone!)</li><li>positive sweep is a positive rotation about <code>x</code></li></ul></div></div><h3 id="External-velocity-at-the-blade"><a class="docs-heading-anchor" href="#External-velocity-at-the-blade">External velocity at the blade</a><a id="External-velocity-at-the-blade-1"></a><a class="docs-heading-anchor-permalink" href="#External-velocity-at-the-blade" title="Permalink"></a></h3><p>Given the position of a blade segment in the rotor plane parametrized by <span>$y_{az}=y_a ,z_{az} = z_a \cos(\beta_0)$</span>, and rotor info <span>$\psi,\Theta,\chi_0$</span>, one can obtain the componnents of the upstream velocity and rotational velocity in the rotor (<span>$x=x_{az},y=y_{az},z=z_{az}$</span>) frame. </p><p class="math-container">\[\begin{aligned}
V_x &amp;= V_\infty \cos(\chi_0) \cos(\Theta) \\
V_y &amp;= V_\infty (\cos(\chi_0) \sin(\Theta) \sin(\psi) - \sin(\chi_0) \cos(\psi) ) + \Omega \cos(\beta_0) z_a \\
V_z &amp;= V_\infty (\cos(\chi_0) \sin(\Theta) \cos(\psi) + \sin(\chi_0) \sin(\psi) ) - \Omega y_a
\end{aligned}\]</p><p>This is essentially Eq.28 in [Ning2015], but expressing the velocities in the frame <em>before</em> precone (and not after), since we are interested in velocities in the rotor plane. <span>$V_\infty$</span> may include a dependency on <span>$z_i$</span> to account for shear.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>Theoretically, <span>$y_a$</span> should be accounted for in the above expression since it may introduce components of rotational velocity in both <span>$V_y,V_z$</span>. We choose to neglect that effect since the sweep deflection is likely small.</p><div class="admonition is-danger"><header class="admonition-header">Danger</header><div class="admonition-body"><p>TODO: CHECK THAT WE NEED THIS, because currently it is coded in the op routine  </p></div></div></div></div><p>Note that in the basic BEM, induction factors are defined with respect to <span>$V_infty$</span> and <span>$R\Omega$</span> respectively. Since all unsteady effects are here neglected, we express the BEM equations by assuming we can replace these with the instantaneous velocities <span>$V_x,V_y$</span>.</p><h3 id="Rotor-mass-flow"><a class="docs-heading-anchor" href="#Rotor-mass-flow">Rotor mass flow</a><a id="Rotor-mass-flow-1"></a><a class="docs-heading-anchor-permalink" href="#Rotor-mass-flow" title="Permalink"></a></h3><p>For an anular section <span>$A_a = 2 \pi r_a dr$</span>, assuming local conditions (velocities) apply to the entire annulus:</p><p class="math-container">\[\dot{m} = \rho A_a (V_x + u_x ) = \rho V_x A_a (1 + a)\]</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Some authors keep the definition of <span>$a = \frac{u_x}{V_\infty}$</span>, which leads to </p><p class="math-container">\[\dot{m} = \rho A_a V_\infty (\cos(\chi_0) \cos(\Theta) + a )\]</p><p>and similar expressions in the sequel. </p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>Is there really a reason to favor one or the other approach?    </p></div></div></div></div><h3 id="Thrust-coefficient"><a class="docs-heading-anchor" href="#Thrust-coefficient">Thrust coefficient</a><a id="Thrust-coefficient-1"></a><a class="docs-heading-anchor-permalink" href="#Thrust-coefficient" title="Permalink"></a></h3><p>With the Prandtl loss function <span>$F$</span>:</p><p class="math-container">\[T = \frac12 \rho V_x^2 A_a C_T = \dot{m} \Delta V F\]</p><p>where the <span>$\Delta$</span> is taken between far-field velocities measured normally to the rotor plane</p><p class="math-container">\[\Delta V = ( V_\infty \cos(\chi_0) - (V_\infty \cos(\chi_0) - \gamma_t \cos(\chi)) ) \cos(\Theta) = \gamma_t \cos(\chi) \cos(\Theta) = 2 u_x \epsilon_x \cos(\chi) \cos(\Theta)\]</p><p>Thus,</p><p class="math-container">\[C_T = 4 a (1 + a) \epsilon_x \cos(\chi) \cos(\Theta) F\]</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>The latter expression is different from that proposed in [McWilliams2011]: <span>$C_T = 4 a (\cos(\chi_0) + \epsilon_x a)  \epsilon_x$</span>.  It is also different from Glauert&#39;s theory, see in [Ning2015]: <span>$C_T = 4 sqrt{ 1 + a (2 \cos(\chi_0) + a)} a F$</span>. All of them collapse to the the propeller-brake/momentum region formula with no yaw <span>$C_T = 4 (1+a) a F$</span> [Ning2021].</p></div></div><h3 id="Torque-coefficient"><a class="docs-heading-anchor" href="#Torque-coefficient">Torque coefficient</a><a id="Torque-coefficient-1"></a><a class="docs-heading-anchor-permalink" href="#Torque-coefficient" title="Permalink"></a></h3><p>Recalling that <span>$u_{\psi_2}$</span> is the far field tangential velocity in the cylinder,</p><p class="math-container">\[Q = \frac12 \rho V_x^2 A_a r_a C_Q = \dot{m} r_a u_{\psi_2} F = \dot{m} r_a 2 u_\psi \epsilon_\psi F\]</p><p class="math-container">\[C_Q = 4 a&#39; (1 + a) \epsilon_\psi V_y / V_x F\]</p><h3 id="Airfoil-aerodynamics"><a class="docs-heading-anchor" href="#Airfoil-aerodynamics">Airfoil aerodynamics</a><a id="Airfoil-aerodynamics-1"></a><a class="docs-heading-anchor-permalink" href="#Airfoil-aerodynamics" title="Permalink"></a></h3><p>The 2-D aerodynamics has to be expressed in a plane normal to the blade axis, rotated by the angle <span>$\beta$</span> and <span>$s$</span> with respect to the rotor reference plane. In fact, the blade is allowed to deflect, and may have a local coning and sweep angle. The forces on the airfoil are transferred to the rotor reference plane so as to express the axial and angular momentum in that reference plane.</p><p><img src="../turbine_deflected.png" alt/></p><p>By definition, <span>$\tan(\phi) = \frac{U_n}{U_t}$</span> that we can rewrite</p><p class="math-container">\[\frac{ \sin(\phi) }{ U_n } - \frac{ \cos(\phi) }{ U_t } = 0\]</p><p>We need two things to happen: obtain the velocities <span>$U_n,U_t$</span> in the local blade frame, and transform the forces expressed in the local blade frame to the rotor frame. </p><p><img src="../blade_vs_rotor.png" alt/></p><p>The local 2-D aerodynamics  yields forces parallel to the normal and tangential direction:</p><p class="math-container">\[\begin{aligned}
f_n &amp;= \frac12 \rho W^2 c c_n(\phi) dr\\
f_t &amp;= \frac12 \rho W^2 c c_t(\phi) dr
\end{aligned}\]</p><p>and we need to express these forces in the coordinate system associated with the rotor disk</p><p class="math-container">\[\begin{aligned}
f_x &amp;= \frac12 \rho W^2 c c_x(c_n,c_t,\beta_0, \theta_0, \beta,s) dr \\
f_y &amp;= \frac12 \rho W^2 c c_y(c_n,c_t,\beta_0, \theta_0, \beta,s) dr
\end{aligned}\]</p><p>where <span>$c_x,c_y$</span> are coordinate transformations (blade to rotor).</p><p>Similarly, we need to express <span>$W, U_n, U_t$</span> as a function of the velocities in the rotor c.s.:</p><p class="math-container">\[[U_n, U_t, U_r]^T = A [U_x, U_y, U_z ]^T = A [V_x (1+a), V_y (1-a&#39;), V_z + V_x a \epsilon_r]^T\]</p><p>where A is the rotation matrix between the rotor frame and the local blade frame (that includes precone <span>$\beta_0$</span>,  pitch<span>$\theta_0$</span>, coning <span>$\beta$</span>, sweep <span>$s$</span>):</p><p class="math-container">\[A = \left(\begin{matrix}
 1               &amp;  0            &amp;    \\
 0               &amp;  \cos s       &amp;  \sin s \\
 0               &amp; -\sin s       &amp;  \cos s
\end{matrix}\right) %
\left(\begin{matrix}
 \cos \beta      &amp;  0                &amp; -\sin \beta\\
 0               &amp;  1                &amp;  0 \\
 \sin \beta      &amp;  0                &amp;  \cos \beta
\end{matrix}\right) %
\left(\begin{matrix}
 \cos \theta_0      &amp;  \sin \theta_0    &amp; 0\\
-\sin \theta_0      &amp;  \cos \theta_0    &amp; 0 \\
 0                  &amp;  0                &amp; 1
\end{matrix}\right) %
\left(\begin{matrix}
 \cos \beta_0      &amp;  0                &amp; -\sin \beta_0\\
 0                 &amp;  1                &amp;  0 \\
 \sin \beta_0      &amp;  0                &amp;  \cos \beta_0 
\end{matrix}\right)\]</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>In theory, <span>$a&#39;$</span> is related to the tangential velocity component <span>$V_\psi$</span> which may slightly differ  from <span>$V_y$</span>  when the blade center line has a non-zero <span>$y$</span> in the azimuthal frame (i.e., the blade is not purely radial). However, we here neglect this effect, assuming that <span>$V_\psi = V_y$</span> and that the rotational induced velocity is similarly obtained <span>$u_y = u_\psi = V_y a&#39;$</span>. This is the main reason for invoking the previously mentioned hypothesis of sweep though shear.</p></div></div><p>The full expression of the total velocities in the airfoil frame reads</p><p class="math-container">\[\left[\begin{matrix} 
U_n \\ 
U_t
\end{matrix}\right] %
\left(\begin{matrix}
\cos \beta  \cos \theta_0 \cos \beta_0 - \sin \beta \sin \beta_0       &amp; \cos \beta \sin \theta_0         &amp; -\cos \beta \cos \theta_0 \sin \beta_0 - \sin \beta \cos \beta_0\\
... &amp; ... &amp; ...\\
\end{matrix}\right)
\left[\begin{matrix} 
V_x (1+a) \\ 
V_y (1-a&#39;)\\
V_z + V_x a \epsilon_r
\end{matrix}\right]\]</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>What we obtain at this stage is a system where we can hardly obtain an expression of <span>$U_n$</span> or <span>$U_t$</span> as a function of only <span>$a$</span> or <span>$a&#39;$</span>. This will prevent the expression of the residual under the form of a single equation, as a function of <span>$\phi$</span>.  However, we notice that if we neglect <span>$A_{12}$</span>, the expression of <span>$U_n$</span> does not depend on <span>$a&#39;$</span> which effectively decouples the system. Similarly, we may want to have that <span>$U_t$</span> only depends on <span>$V_y$</span>.  We will thus arbitrarily set <span>$\sin \theta_0 = 0$</span>, which achieves both objectives.</p><p>We further neglect the sweep angle in this coordinate transformation, to simplify the expressions and because sweep angle is generally small.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>For consistency, we also neglect the sweep in <span>$c_x,c_y$</span>..</p></div></div></div></div><p>With these assumtions, we obtain</p><p class="math-container">\[\begin{aligned}
U_n &amp;= (\cos \beta  \cos \theta_0 \cos \beta_0 - \sin \beta \sin \beta_0) V_x ( 1 + a) - (\cos \beta \cos \theta_0 \sin \beta_0 + \sin \beta \cos \beta_0) ( V_z + V_x a \epsilon_r) \\
U_t &amp;=  \cos \theta_0 V_y  (1-a&#39;)
\end{aligned}\]</p><p>Thus,</p><p class="math-container">\[\begin{aligned}
U_n &amp;= p_1 V_x ( 1 + a) + p_2 ( V_z + V_x a \epsilon_r) \\
U_t &amp;= p_3 V_y  (1-a&#39;)
\end{aligned}\]</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>With unsteady flexible blades, the displacement velocity of the blades expressed in the airfoil frame, <span>$v_n, v_t$</span>, may be added directly here:</p><p class="math-container">\[\begin{aligned}
U_n &amp;= ... - v_n \\
U_t &amp;= ... - v_t
\end{aligned}\]</p><p>This only slightly modifies the BEM equations hereunder.</p><div class="admonition is-danger"><header class="admonition-header">Danger</header><div class="admonition-body"><p>Maybe more than slightly... Consider doing <span>$a (V_x+v_x) = u_x$</span>, i.e. add deflection velocity to the external velocities?</p></div></div></div></div><h3 id="BEM-equations"><a class="docs-heading-anchor" href="#BEM-equations">BEM equations</a><a id="BEM-equations-1"></a><a class="docs-heading-anchor-permalink" href="#BEM-equations" title="Permalink"></a></h3><p>The 1-equation residual reads:</p><p class="math-container">\[R(\phi) = \frac{ \sin(\phi) }{ U_n } - \frac{ \cos(\phi) }{ U_t } = 0\]</p><p>where the expressions for <span>$U_n, U_t$</span> were given at the bottom of the previous section, as a function of the unknown inductions. Also, <span>$W = \frac{U_n}{\sin \phi} = \frac{U_t}{\cos \phi}$</span>.</p><p>We obtain an expression for <span>$a,a&#39;$</span> as a function of <span>$\phi$</span> by equating the momentum equations and the local 2D aerodynamics (recast in terms of local thrust coef.), </p><p class="math-container">\[C_T = 4 a (1 + a) \epsilon_x \cos(\chi) \cos(\Theta) F = \frac{B c }{2 \pi z_a} \frac{W^2}{V_x^2} c_x\]</p><p class="math-container">\[C_Q = 4 a&#39; (1 + a) \epsilon_\psi V_y / V_x F = \frac{B c }{2 \pi z_a} \frac{W^2}{V_x^2} c_y\]</p><p>For the thrust coefficient, this leads to:</p><p class="math-container">\[\frac{a (1 + a)}{( (p_1 V_x + p_2 V_z) + (p_1 + p_2 \epsilon_r) V_x a )^2} = \frac{1}{ \epsilon_x \cos(\chi) \cos(\Theta)F V_x^2 \sin^2\phi} \frac{B c c_x}{8 \pi z_a} \overset{\Delta}{=} \kappa\]</p><p>We can then solve for <span>$a$</span>:</p><p class="math-container">\[\frac{a(1+a)}{(b_1 + b_2 a)^2} = \kappa \]</p><p class="math-container">\[a = \frac{-2 b_1 b_2 \kappa +1 \pm \sqrt{4 b_1^2 \kappa - b_1 b_2 \kappa + 1}}{2(b_2^2 \kappa -1)} \quad \textrm{with} \pm b_2 \sqrt{4 b_1^2 \kappa - b_1 b_2 \kappa + 1} - 2 b_1 + b_2 \ne 0\]</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>There are two roots to this equation. Hopefully, one can be ruled out from physics considerations. This has to be verified, though.</p></div></div><p>Knowing <span>$a$</span>, and using the various expressions for <span>$W$</span>, the tangential equilibrium yields ...</p><p class="math-container">\[\frac{a&#39;}{1-a&#39;} = \frac{b_1 + b_2 a}{V_x (1+a)}  \underbrace{\frac{p_3}{4\epsilon_\psi F \sin\phi \cos\phi} \frac{B c c_y} {2\pi z_a} }_{\overset{\Delta}{=} \kappa&#39;}\]</p><p>that we can easily invert for <span>$a&#39;$</span> &quot;as usual&quot;.</p><p>:tada: </p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p><strong>Relation with the original BEM</strong> The main difference to remember is that, with the present expression of the BEM equation, everything is written in the blade azimuthal frame whereas the original implementation considered the thrust in the blade root frame (i.e. normal to the blade and not normal to the rotor). We </p><p>However, by considering the following changes, the present implementation reverts to the original CCBlade implementation:</p><ul><li>the wake epsilon factor take their original value: <span>$\epsilon_x= \epsilon_\psi = 1, \epsilon_r = 0$</span></li><li>tilt and yaw do not enter the in <span>$\kappa,\kappa&#39;$</span>: <span>$\cos(\Theta) = \cos(\chi) = 1$</span>, </li><li><code>sigma_p = B*chord/(2.0*pi*r)</code> where <code>r</code> does not account for precone. </li><li>the velocity normal to the blade is <code>Vx = (cos(precone) * Vx_az - sin(precone) * Vz_az)</code>. Everywhere else, we set <code>p1 = 1, p2 = 0</code> such that <code>cn = cx, ct = cy, b2 = b1 = Vx</code></li><li>the local thrust (<code>Np</code>) is rotated by the precone angle before the integration of the rotor thrust.</li></ul><p>For backward compatibility, this remains the default behavior of the code. The new implementation is turned on only when passing <code>wakeCyl = true</code> to the rotor object.</p></div></div><h3 id="Summary-of-the-assumptions"><a class="docs-heading-anchor" href="#Summary-of-the-assumptions">Summary of the assumptions</a><a id="Summary-of-the-assumptions-1"></a><a class="docs-heading-anchor-permalink" href="#Summary-of-the-assumptions" title="Permalink"></a></h3><ul><li><p>we neglect the influence of the bound vortices of the other blades on the current blade. This is valid if all the blade have the same circulation, which is not exactly the case in yaw or with shear.</p></li><li><p>we neglect the influence of the longitudinal vorticity components of the tip cylinder on the velocity measured normal to the disk </p></li><li><p>we still assume the independance of each annular section (theoretically only valid for no yaw, no cone, and high TSR  [Branlard2015]). Otherwise, the determination of the axial induction at a given radial station would depend on all the other sations, requiring to solve a large system of equations (see also [Branlard2015, sect.4.3]). </p></li><li><p>the wake geometry is assumed as explained above: no wake expansion, plus the wake vorticity is only shed at the blade root and the blade tip.    The wake expansion could be taken into account by a discretization in the axial direction [Crawford2006] and iterations... But anyway, the wake expansion results in an increase of induction near the tip, which is overtaken by the Prandtl tip correction.</p></li><li><p>the evaluation of the pitch of the helix <span>$h$</span> assumes high TSR</p></li><li><p>we neglect the blade flap/coning angle when evaluating the <code>epsilon</code> factors. The reason is that the cylider wake model is centered on the rotor hub, and does not come forward when the blades bend.</p></li><li><p>we neglect the wake redirection by the tilt angle (i.e., the wake is parallel to the ground). Even more, we consider that the integrals <span>$I$</span> in the computation of the induced velocities do not depend on <span>$\Theta$</span>.</p></li></ul><ul><li>we neglect the sweep angle in the computation of the normal and tangential velocities (this angle should be small anyway) <em>This assumption might be unnecessary.</em></li></ul><h2 id="TODO"><a class="docs-heading-anchor" href="#TODO">TODO</a><a id="TODO-1"></a><a class="docs-heading-anchor-permalink" href="#TODO" title="Permalink"></a></h2><ul><li>[ ] write the expressions for <span>$I$</span></li><li>[ ] checks sign consistency between wake model and BEM: psi, yaw, tilt</li><li>[ ] check sign consistency of <span>$a$</span>, etc. with Ning2021</li><li>[ ] shall we define a=ux/Uinf or a=ux/Ux ?</li><li>[ ] smoothly connect to the high induction model. Treat the particular cases ofsome missing velocities</li><li>[ ] would it be better to pre-evaluate epsilon and look it up during BEM computation, or can we just keep re-evaluating it on the run?</li><li>[ ] update <code>openmdao/python/ccblade</code> </li><li>[ ] test the whole method with con/swp.</li></ul><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><ul><li><a href="https://doi.org/10.1007/s11044-015-9488-1">[Branlard2016]</a> Branlard, E. and Gaunaa, M. Cylindrical vortex wake model: skewed cylinder, application to yawed or tilted rotors. Wind Energy, 2016.</li><li><a href="https://doi.org/10.1002/we.1800">[Branlard2015]</a> Branlard, E. and Gaunaa, M. Cylindrical vortex wake model: right cylinder. Wind Energy, 2015.</li><li><a href="https://doi.org/10.1002/we.197">[Crawford2006]</a> C. Crawford. Re-examining the precepts of the blade element momentum theory for coning rotors. Wind Energy, 9(5):457–478, 2006.</li><li><a href="https://doi.org/10.2514/6.2011-540">[McWilliams2011]</a> M. McWilliam, S. Lawton, S. Cline, and C. Crawford. A corrected blade element momentum method for simulating wind turbines in yawed flow. In 49th AIAA Aerospace Sciences Meeting including the New Horizons Forum and Aerospace Exposition, 2011.</li><li><a href="https://doi.org/10.1115/OMAE2018-78219">[Micallef2016]</a> D. Micallef and T. Sant. A review of wind turbine yaw aerodynamics. Wind Turbines-Design, Control and Applications, 2016.</li><li><a href="https://doi.org/10.2514/6.2015-0215">[Ning2015]</a> A. Ning, G. Hayman, R. Damiani, and J. M. Jonkman. Development and validation of a new blade element momentum skewed-wake model within aerodyn. In 33rd Wind Energy Symposium, 2015.</li><li><a href="https://doi.org/10.1007/s00158-021-02883-6">[Ning2021]</a> Ning, A., Using Blade Element Momentum Methods with Gradient-Based Design Optimization, Structural and Multidisciplinary Optimization, May 2021.</li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../theory/">« Theory</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.10 on <span class="colophon-date" title="Tuesday 18 January 2022 01:17">Tuesday 18 January 2022</span>. Using Julia version 1.6.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
